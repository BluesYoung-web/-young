{"version":3,"file":"index.cjs.js","sources":["../src/styles/index.css?used&raw","../src/styles/close-icon.svg?raw","../src/core/create.ts","../src/core/position.ts","../src/type.ts","../src/index.ts"],"sourcesContent":["export default \"#mask {\\n  width: 100vw;\\n  height: 100vh;\\n  background-color: gray;\\n  opacity: 0.6;\\n  position: fixed;\\n  top: 0;\\n}\\n#dialog {\\n  width: 400px;\\n  height: 300px;\\n  background-color: #fff;\\n  position: fixed;\\n  top: 0;\\n}\\n#dialog .title {\\n  text-align: center;\\n}\\n\\n#dialog .content {\\n  text-align: center;\\n}\\n\\n#dialog .btns {\\n  position: absolute;\\n  display: -webkit-box;\\n  display: -webkit-flex;\\n  display: -ms-flexbox;\\n  display: flex;\\n  -webkit-justify-content: space-around;\\n      -ms-flex-pack: distribute;\\n          justify-content: space-around;\\n  bottom: 0;\\n  width: 100%;\\n  padding: 10%;\\n  -webkit-box-sizing: border-box;\\n          box-sizing: border-box;\\n}\\n#dialog .btns button {\\n  cursor: pointer;\\n}\\n\\n#dialog-close {\\n  position: absolute;\\n  right: 0;\\n  top: 0;\\n  padding: 0.6rem;\\n  cursor: pointer;\\n}\"","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" aria-hidden=\\\"true\\\" role=\\\"img\\\" class=\\\"iconify iconify--ion\\\" width=\\\"24\\\" height=\\\"24\\\" preserveAspectRatio=\\\"xMidYMid meet\\\" viewBox=\\\"0 0 512 512\\\"><path d=\\\"M331.3 308.7L278.6 256l52.7-52.7c6.2-6.2 6.2-16.4 0-22.6-6.2-6.2-16.4-6.2-22.6 0L256 233.4l-52.7-52.7c-6.2-6.2-15.6-7.1-22.6 0-7.1 7.1-6 16.6 0 22.6l52.7 52.7-52.7 52.7c-6.7 6.7-6.4 16.3 0 22.6 6.4 6.4 16.4 6.2 22.6 0l52.7-52.7 52.7 52.7c6.2 6.2 16.4 6.2 22.6 0 6.3-6.2 6.3-16.4 0-22.6z\\\" fill=\\\"#434343\\\"></path><path d=\\\"M256 76c48.1 0 93.3 18.7 127.3 52.7S436 207.9 436 256s-18.7 93.3-52.7 127.3S304.1 436 256 436c-48.1 0-93.3-18.7-127.3-52.7S76 304.1 76 256s18.7-93.3 52.7-127.3S207.9 76 256 76m0-28C141.1 48 48 141.1 48 256s93.1 208 208 208 208-93.1 208-208S370.9 48 256 48z\\\" fill=\\\"currentColor\\\"></path></svg>\"","/*\n * @Author: zhangyang\n * @Date: 2022-05-20 16:33:38\n * @LastEditTime: 2022-05-23 11:09:00\n * @Description: \n */\n/// <reference types=\"vite/client\" />\nimport type { YoungBeginnerGuidController } from '../index';\nimport cssContent from '../styles/index.css?raw';\nimport closeIcon from '../styles/close-icon.svg?raw';\nexport const createEL = (attrs: Record<string, string> = {}, tag: keyof HTMLElementTagNameMap = 'div') => {\n  const el = document.createElement(tag);\n  Object.entries(attrs).forEach(([key, value]) => {\n    el.setAttribute(key, value);\n  });\n  return el;\n};\n\nexport const createItem = (handler: YoungBeginnerGuidController, zIndex: number = 3000) => {\n  const mask = createEL({ id: 'mask' });\n  const dialog = document.createElement('div');\n  dialog.setAttribute('id', 'dialog');\n  dialog.innerHTML = `\n  ${!handler.force\n    ? `<div id=\"dialog-close\" title=\"ÂÖ≥Èó≠Êñ∞ÊâãÂºïÂØº\">${closeIcon}</div>`\n    : ''\n  }\n  <div class=\"btns\">\n    <button id=\"prev\" type=\"button\">‰∏ä‰∏ÄÊ≠•</button>\n    <button id=\"next\" type=\"button\">‰∏ã‰∏ÄÊ≠•</button>\n  </div>\n  `;\n  dialog.querySelector('#prev').addEventListener('click', () => handler.prev());\n  dialog.querySelector('#next').addEventListener('click', () => {\n    if (handler.index === handler.guids.length - 1) {\n      handler.hide();\n    } else {\n      handler.next();\n    }\n  });\n  !handler.force && dialog.querySelector('#dialog-close').addEventListener('click', () => handler.hide());\n\n  const title = createEL({ class: 'title' }, 'h3');\n  title.setAttribute('slot', 'title');\n  \n  const content = createEL({ class: 'content' });\n  content.setAttribute('slot', 'content');\n\n  dialog.prepend(content);\n  dialog.prepend(title);\n  \n  const container = createEL();\n\n  const styles = createEL({}, 'style');\n  styles.innerHTML = `\n  #mask {\n    z-index: ${zIndex};\n  }\n  #dialog {\n    z-index: ${zIndex + 1};\n  }\n  ${cssContent}\n  `;\n\n  container.prepend(styles);\n  container.appendChild(mask);\n  container.appendChild(dialog);\n\n  return container;\n};","/*\n * @Author: zhangyang\n * @Date: 2022-05-20 17:00:04\n * @LastEditTime: 2022-05-20 17:45:06\n * @Description: \n */\nimport type { Position, Selector } from './../type';\nexport const getPosition = (selector: Selector) => {\n  const el = document.querySelector(selector);\n  const { left, top, right, bottom } = el.getBoundingClientRect();\n  // console.log(\"üöÄ ~ file\", el.getBoundingClientRect())\n\n  let positionX: Position = 'left';\n  let positionY: Position = 'top';\n  let x = right + 50;\n  let y = top;\n\n  if (window.innerWidth - right < 400) {\n    positionX = 'right';\n    x = left - 50;\n  }\n\n  if (window.innerHeight - top < 300) {\n    positionY = 'bottom';\n    y = bottom;\n  }\n  return {\n    x,\n    y,\n    positionX,\n    positionY\n  };\n};","/*\n * @Author: zhangyang\n * @Date: 2022-05-20 10:43:29\n * @LastEditTime: 2022-05-23 11:03:57\n * @Description: \n */\nexport type Position = \n| 'left'\n| 'right'\n| 'top'\n| 'bottom';\n\nexport type Selector = keyof HTMLElementTagNameMap | keyof SVGElementTagNameMap | `.${string}` | `#${string}` | `[${string}]`;\n\nexport type GuidItem = {\n  el: Selector;\n  title: string;\n  content: string;\n};\ndocument.querySelector\nexport type GuidOptions = {\n  /**\n   * ÂÆû‰æãÂåñ‰πãÂêéÁ´ãÂç≥ÂºÄÂßã\n   * @default false\n   */\n  immdiate?: boolean;\n  /**\n   * Âº∫Âà∂ËøõË°åÊñ∞ÊâãÂºïÂØºÔºåÊó†Ê≥ïÁõ¥Êé•ÂÖ≥Èó≠\n   * @default false\n   */\n  force?: boolean;\n};\n\nexport const defautOptions: GuidOptions = {\n  immdiate: false,\n  force: false\n};","/*\n * @Author: zhangyang\n * @Date: 2022-05-20 10:42:47\n * @LastEditTime: 2022-05-23 14:19:12\n * @Description: \n */\nimport { createItem, getPosition } from './core';\nimport type { GuidItem, GuidOptions, Selector } from './type';\nimport { defautOptions } from './type';\n\ntype CurrStep = {\n  visible: boolean;\n  index: number;\n  step: GuidItem;\n}\n\nexport class YoungBeginnerGuid extends HTMLElement {\n  public root: ShadowRoot;\n  public snap: {\n    el: Selector;\n    style: string;\n  };\n  constructor(public handler: YoungBeginnerGuidController) {\n    super();\n    const mask = createItem(handler);\n    const shadowRoot = this.attachShadow({ mode: 'closed' });\n    shadowRoot.appendChild(mask);\n\n    this.root = shadowRoot;\n  }\n\n  changeVisiable(item: CurrStep) {\n    if (item.visible) {\n      this.style.display = 'block';\n    } else {\n      this.style.display = 'none';\n    }\n  }\n\n  changeDialog(item: CurrStep, dialog: HTMLElement) {\n    const {\n      x,\n      y,\n      positionX,\n      positionY\n    } = getPosition(item.step.el);\n    dialog.style[positionX] = x + 'px';\n    dialog.style[positionY] = y + 'px';\n  }\n\n  changeContent(item: CurrStep, dialog: HTMLElement) {\n    const title = dialog.querySelector('.title');\n    const content = dialog.querySelector('.content');\n\n    title.innerHTML = item.step.title;\n    content.innerHTML = item.step.content;\n  }\n\n  changeButton(item: CurrStep, dialog: HTMLElement) {\n    const prev = dialog.querySelector('#prev');\n    const next = dialog.querySelector('#next');\n    if (item.index === 0) {\n      prev.setAttribute('disabled', 'disabled');\n    } else {\n      prev.removeAttribute('disabled');\n    }\n\n    if (item.index === this.handler.guids.length - 1) {\n      next.innerHTML = 'ÂÖ≥Èó≠';\n    } else {\n      next.innerHTML = '‰∏ã‰∏ÄÊ≠•';\n    }\n  }\n\n  saveSnapAndChange(item: CurrStep) {\n    const el = document.querySelector(item.step.el) as HTMLElement;\n    this.snap = {\n      el: item.step.el,\n      style: el.style.border\n    };\n\n    el.style.border = '2px solid red';\n  }\n  restoreSnap() {\n    const el = document.querySelector(this.snap?.el) as HTMLElement;\n    el && (el.style.border = this.snap.style);\n  }\n\n  render(item: CurrStep) {\n    // hack vitest\n    if (globalThis?.process?.env?.TEST) {\n      return;\n    }\n    // ÂØπ mask ‰ΩøÁî® clip-path: polygon ÊïàÊûúÊõ¥Â•ΩÔºå‰ΩÜÊòØÈúÄË¶ÅËøõË°åÂ§çÊùÇÁöÑËÆ°ÁÆó\n    // ‰øÆÊîπÊ†∑ÂºèÂπ∂‰øùÂ≠òÁé∞Âú∫ÔºåÊ≠§Â§ÑÁÆÄÂåñ‰∏∫ÁªôÁõÆÊ†áÂÖÉÁ¥†Âä†ËæπÊ°Ü\n    this.saveSnapAndChange(item);\n\n    this.changeVisiable(item);\n\n    const dialog = this.root.querySelector('#dialog') as HTMLElement;\n    this.changeDialog(item, dialog);\n    this.changeContent(item, dialog);\n    this.changeButton(item, dialog);\n  }\n};\nwindow.customElements.get('young-beginner-guid') ||\nwindow.customElements.define('young-beginner-guid', YoungBeginnerGuid);\n\nexport class YoungBeginnerGuidController {\n  public index = 0;\n  public immdiate = false;\n  public force = false;\n\n  public guids: GuidItem[];\n  public el: YoungBeginnerGuid;\n\n  constructor(guids: GuidItem[], options: GuidOptions = {}) {\n    this.guids = guids;\n    options = Object.assign(defautOptions, options);\n    this.immdiate = options.immdiate;\n    this.force = options.force;\n\n    this.el = new YoungBeginnerGuid(this);\n\n    window.addEventListener('load', () => {\n      this.immdiate && this.show();\n    });\n  }\n\n  show(index = 0, visible = true) {\n    if (!this.el.isConnected) {\n      document.body.appendChild(this.el);\n    }\n\n    this.index = index;\n    // ÊÅ¢Â§çÁé∞Âú∫\n    this.el.restoreSnap();\n    // ÂºÄÂßãÊ∏≤Êüì\n    this.el.render({\n      visible,\n      index,\n      step: this.guids[index]\n    });\n  }\n\n  next() {\n    if (this.index < this.guids.length - 1) {\n      this.index++;\n      this.show(this.index);\n    }\n  }\n\n  prev() {\n    if (this.index > 0) {\n      this.index--;\n      this.show(this.index);\n    }\n  }\n\n  hide() {\n    this.show(this.index, false);\n    // ÊÅ¢Â§çÁé∞Âú∫\n    this.el.restoreSnap();\n  }\n\n  destory() {\n    this.index = 0;\n    document.body.removeChild(this.el);\n    // ÊÅ¢Â§çÁé∞Âú∫\n    this.el.restoreSnap();\n  }\n}"],"names":[],"mappings":"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"}