{"version":3,"file":"index.es.js","sources":["../src/index.ts"],"sourcesContent":["/*\n * @Author: zhangyang\n * @Date: 2022-07-02 14:36:13\n * @LastEditTime: 2022-07-25 09:07:04\n * @Description: \n */\ntype AuthConfig = {\n  /**\n   * 微信公众号 appid\n   */\n  appid: string;\n  /**\n   * state 标志位的内容\n   * @default 'young_wechat_auth'\n   */\n  state?: string;\n  /**\n   * 授权类型\n   * @default 'snsapi_base'\n   */\n  scope?: 'snsapi_base' | 'snsapi_userinfo';\n};\n\nconst defaultConfig: Partial<AuthConfig> = {\n  state: 'young_wechat_auth',\n  scope: 'snsapi_base'\n};\n\nexport default class {\n  public auth_url: string;\n\n  constructor(conf: AuthConfig) {\n    conf = Object.assign(defaultConfig, conf);\n    this.auth_url = `https://open.weixin.qq.com/connect/oauth2/authorize?appid=${conf.appid}&redirect_uri=${encodeURIComponent(location.href)}&response_type=code&scope=${conf.scope}&state=${conf.state}#wechat_redirect`;\n  }\n  \n  getCode() {\n    const args = new URLSearchParams(location.search);\n    const code = args.get('code');\n    const state = args.get('state');\n    if (state) {\n      return code;\n    } else {\n      location.href = this.auth_url;\n    }\n  }\n}"],"names":[],"mappings":"AAuBA,MAAM,gBAAqC;AAAA,EACzC,OAAO;AAAA,EACP,OAAO;AACT;AAEqB,MAAA,MAAA;AAAA,EAGnB,YAAY,MAAkB;AACrB,WAAA,OAAO,OAAO,eAAe,IAAI;AACnC,SAAA,WAAW,6DAA6D,KAAK,sBAAsB,mBAAmB,SAAS,IAAI,8BAA8B,KAAK,eAAe,KAAK;AAAA,EACjM;AAAA,EAEA,UAAU;AACR,UAAM,OAAO,IAAI,gBAAgB,SAAS,MAAM;AAC1C,UAAA,OAAO,KAAK,IAAI,MAAM;AACtB,UAAA,QAAQ,KAAK,IAAI,OAAO;AAC9B,QAAI,OAAO;AACF,aAAA;AAAA,IAAA,OACF;AACL,eAAS,OAAO,KAAK;AAAA,IACvB;AAAA,EACF;AACF;;"}