{"version":3,"file":"index.es.js","sources":["../src/index.ts"],"sourcesContent":["/*\r\n * @Author: zhangyang\r\n * @Date: 2022-07-02 14:36:13\r\n * @LastEditTime: 2022-07-23 15:55:40\r\n * @Description: \r\n */\r\ntype AuthConfig = {\r\n  /**\r\n   * 微信公众号 appid\r\n   */\r\n  appid: string;\r\n  /**\r\n   * state 标志位的内容\r\n   * @default 'young_wechat_auth'\r\n   */\r\n  state?: string;\r\n  /**\r\n   * 授权类型\r\n   * @default 'snsapi_base'\r\n   */\r\n  scope?: 'snsapi_base' | 'snsapi_userinfo';\r\n};\r\n\r\nconst defaultConfig: Partial<AuthConfig> = {\r\n  state: 'young_wechat_auth',\r\n  scope: 'snsapi_base'\r\n};\r\n\r\nexport default class {\r\n  constructor(conf: AuthConfig) {\r\n    conf = Object.assign(defaultConfig, conf);\r\n    const args = new URLSearchParams(location.search);\r\n    const code = args.get('code');\r\n    const state = args.get('state');\r\n    if (state) {\r\n      return code;\r\n    } else {\r\n      location.href = `https://open.weixin.qq.com/connect/oauth2/authorize?appid=${conf.appid}&redirect_uri=${encodeURIComponent(location.href)}&response_type=code&scope=${conf.scope}&state=${conf.state}#wechat_redirect`;\r\n    }\r\n  }\r\n}"],"names":[],"mappings":"AAuBA,MAAM,gBAAqC;AAAA,EACzC,OAAO;AAAA,EACP,OAAO;AACT;AAEqB,MAAA,MAAA;AAAA,EACnB,YAAY,MAAkB;AACrB,WAAA,OAAO,OAAO,eAAe,IAAI;AACxC,UAAM,OAAO,IAAI,gBAAgB,SAAS,MAAM;AAC1C,UAAA,OAAO,KAAK,IAAI,MAAM;AACtB,UAAA,QAAQ,KAAK,IAAI,OAAO;AAC9B,QAAI,OAAO;AACF,aAAA;AAAA,IAAA,OACF;AACI,eAAA,OAAO,6DAA6D,KAAK,sBAAsB,mBAAmB,SAAS,IAAI,8BAA8B,KAAK,eAAe,KAAK;AAAA,IACjM;AAAA,EACF;AACF;;"}