"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),p=require("@bluesyoung/utils"),v=require("element-plus"),T=require("@vueuse/core"),B=e.defineComponent({props:{tableData:{type:Object,required:!0},tableHead:{type:Object,required:!0},tableHeight:{type:Number,default:600}},emits:["sort-change"],setup(a,{emit:u,attrs:s,slots:t}){const o=e.ref(null);e.onActivated(()=>{e.nextTick(()=>{o.value.doLayout()})});const l=e.ref([]),d=e.ref([]);return e.watchEffect(()=>{const i=a.tableData,n=a.tableHead,r=i.length;e.nextTick(()=>{d.value=n.filter(c=>!c.only_export);const g=50;if(r<=g)l.value=p.deepClone(i);else{const{elArr:c,load:y}=N(l,e.ref(i),g);let m=0;l.value=i.slice(m,g),e.nextTick(()=>{c.value=o.value.$el.querySelector("tbody").children,y()})}})}),()=>e.createVNode(v.ElTable,e.mergeProps(s,{ref:o,data:l.value,style:"width: 100%",height:a.tableHeight,onSortChange:i=>u("sort-change",i)}),{default:()=>{var i,n;return[d.value.map((r,g)=>e.createVNode(v.ElTableColumn,{key:g,prop:r.prop,label:r.label,width:r.width||"",sortable:r.sortable||!1,fixed:r.fixed||!1,align:r.aligin||"left"},{header:c=>d.value[c.$index].tool_content?e.createVNode(e.Fragment,null,[e.createVNode("span",null,[c.column.label]),e.createVNode(v.ElTooltip,{placement:"bottom"},{content:()=>d.value[c.$index].tool_content})]):e.createVNode("span",null,[c.column.label]),default:c=>r.render?r.render(c.row):e.createVNode("span",null,[c.row[r.prop]])})),(i=t.switch)==null?void 0:i.call(t),(n=t.operate)==null?void 0:n.call(t)]}})}}),h={type:Number,required:!0},S=e.defineComponent({props:{total:h,page:h,limit:h,pageSizes:{type:Object,default:()=>[10,20,30,50]},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},emits:["page-change","update:page","update:limit"],setup(a,{emit:u,attrs:s}){const t=l=>{u("update:page",1),u("update:limit",l),u("page-change")},o=l=>{u("update:page",l),u("page-change")};return()=>e.createVNode("div",{style:"background: white; padding-top: 20px;"},[e.createVNode(v.ElPagination,e.mergeProps(s,{background:a.background,currentPage:a.page,pageSize:a.limit,layout:a.layout,pageSizes:a.pageSizes,total:a.total,"onUpdate:page-size":l=>t(l),"onUpdate:current-page":l=>o(l)}),null)])}}),F=e.defineComponent({props:{modelValue:Boolean,realTitle:String,sureText:{type:String,default:"\u786E\u5B9A"},cancelText:{type:String,default:"\u53D6\u6D88"},showSure:{type:Boolean,default:!0},showCancel:{type:Boolean,default:!0},isAdd:Boolean,isEdit:Boolean,isMore:Boolean,sureFn:Function},emits:["sure","clear","update:modelValue"],setup(a,{emit:u,attrs:s,slots:t}){const o=e.computed(()=>{let n="\u65B0\u5EFA";return a.isEdit&&(n="\u7F16\u8F91"),a.isMore&&(n="\u8BE6\u60C5"),n}),l=e.computed({get:()=>a.isAdd||a.isMore||a.isEdit,set:n=>null}),d=async()=>{if(!(a.sureFn&&await a.sureFn()===!1)){if(a.isMore){u("clear");return}u("update:modelValue",!1),u("sure")}},i=()=>{if(a.isMore||!a.showCancel){u("clear"),u("update:modelValue",!1);return}v.ElMessageBox.confirm("\u6570\u636E\u672A\u4FDD\u5B58\uFF0C\u5173\u95ED\u5C06\u4E22\u5931\u6570\u636E\uFF0C\u786E\u8BA4\u5173\u95ED\uFF1F","\u63D0\u793A").then(()=>{u("update:modelValue",!1),u("clear")}).catch(()=>null)};return()=>e.createVNode(e.Teleport,{to:"body"},{default:()=>[e.createVNode(v.ElDialog,e.mergeProps(s,{modelValue:a.modelValue||l.value,title:a.realTitle||o.value,closeOnClickModal:!1,closeOnPressEscape:!1,beforeClose:i}),{default:()=>{var n;return(n=t.body)==null?void 0:n.call(t)},footer:()=>{var n,r,g;return e.createVNode(e.Fragment,null,[(n=t.button)==null?void 0:n.call(t),a.showCancel&&e.createVNode(v.ElButton,{onClick:()=>i()},{default:()=>[a.cancelText]}),(r=t.step1)==null?void 0:r.call(t),(g=t.step2)==null?void 0:g.call(t),a.showSure&&e.createVNode(v.ElButton,{type:"primary",onClick:()=>d()},{default:()=>[a.sureText]})])}})]})}}),N=(a,u,s=10,t=e.ref(!1))=>{const o=e.ref([]),l=e.ref(!1),d=e.ref(1),i=()=>{const{stop:n}=T.useIntersectionObserver(o.value[a.value.length-1],([{isIntersecting:r}])=>{r&&(l.value=r,n())})};return e.watchEffect(async()=>{if(!t.value&&l.value){if(a.value.length===u.value.length)return;d.value++;const n=u.value.slice(s*(d.value-1),s*d.value);if(n.length===0)return;a.value.push(...n),l.value=!1,await e.nextTick(),i()}}),{elArr:o,touchEndEl:l,page:d,load:i}},M=(a,{addCbk:u,modCbk:s,delCbk:t,cpEffect:o,cgEffect:l,disableclear:d},i="\u786E\u8BA4\u5220\u9664\u8BE5\u6761\u6570\u636E\uFF1F")=>{const n=e.ref(!1),r=e.ref(!1),g=e.ref(!1),c=e.ref(p.deepClone(a)),y=e.ref(),m=async()=>await new Promise(w=>{var V;(V=y.value)==null||V.validate(async x=>{x&&w(!0)}).catch(x=>{w(!1)})}),b=()=>{n.value=!1,r.value=!1,g.value=!1,c.value=p.deepClone(a)};return{isAdd:n,isEdit:r,isMore:g,clear:b,edit:f=>{o==null||o(f),c.value=p.deepClone(f),r.value=!0},more:f=>{o==null||o(f),c.value=p.deepClone(f),g.value=!0},form:c,del:f=>{v.ElMessageBox.confirm(i,"\u63D0\u793A",{type:"warning"}).then(async()=>{await(t==null?void 0:t(f)),l==null||l()}).catch(()=>null)},sure:async()=>{if(n.value){if(await(u==null?void 0:u())===!1)return}else if(await(s==null?void 0:s())===!1)return;!d&&b(),l==null||l()},formRef:y,validForm:m}};exports.YoungDialog=F;exports.YoungPagination=S;exports.YoungTable=B;exports.useAutoLoad=N;exports.useFormMode=M;
//# sourceMappingURL=index.cjs.js.map
