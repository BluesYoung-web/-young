"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),v=require("@bluesyoung/utils"),f=require("element-plus"),x=require("@vueuse/core"),T=e.defineComponent({props:{tableData:{type:Object,required:!0},tableHead:{type:Object,required:!0},tableHeight:{type:Number,default:600}},emits:["sort-change"],setup(t,{emit:u,attrs:d,slots:a}){const o=e.ref(null);e.onActivated(()=>{e.nextTick(()=>{o.value.doLayout()})});const n=e.ref([]),s=e.ref([]);return e.watchEffect(()=>{const i=t.tableData,l=t.tableHead,r=i.length;e.nextTick(()=>{s.value=l.filter(c=>!c.only_export);const g=50;if(r<=g)n.value=v.deepClone(i);else{const{elArr:c,load:y}=S(n,e.ref(i),g);let m=0;n.value=i.slice(m,g),e.nextTick(()=>{c.value=o.value.$el.querySelector("tbody").children,y()})}})}),()=>e.createVNode(f.ElTable,e.mergeProps(d,{ref:o,data:n.value,style:"width: 100%",height:t.tableHeight,onSortChange:i=>u("sort-change",i)}),{default:()=>{var i,l;return[s.value.map((r,g)=>e.createVNode(f.ElTableColumn,{key:g,prop:r.prop,label:r.label,width:r.width||"",sortable:r.sortable||!1,fixed:r.fixed||!1,align:r.aligin||"left"},{header:c=>s.value[c.$index].tool_content?e.createVNode(e.Fragment,null,[e.createVNode("span",null,[c.column.label]),e.createVNode(f.ElTooltip,{placement:"bottom"},{content:()=>s.value[c.$index].tool_content})]):e.createVNode("span",null,[c.column.label]),default:c=>r.render?r.render(c.row):e.createVNode("span",null,[c.row[r.prop]])})),(i=a.switch)==null?void 0:i.call(a),(l=a.operate)==null?void 0:l.call(a)]}})}}),b={type:Number,required:!0},B=e.defineComponent({props:{total:b,page:b,limit:b,pageSizes:{type:Object,default:()=>[10,20,30,50]},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},emits:["page-change","update:page","update:limit"],setup(t,{emit:u,attrs:d}){const a=n=>{u("update:page",1),u("update:limit",n),u("page-change")},o=n=>{u("update:page",n),u("page-change")};return()=>e.createVNode("div",{style:"background: white; padding-top: 20px;"},[e.createVNode(f.ElPagination,e.mergeProps(d,{background:t.background,currentPage:t.page,pageSize:t.limit,layout:t.layout,pageSizes:t.pageSizes,total:t.total,"onUpdate:page-size":n=>a(n),"onUpdate:current-page":n=>o(n)}),null)])}}),P=e.defineComponent({props:{modelValue:Boolean,realTitle:String,sureText:{type:String,default:"\u786E\u5B9A"},cancelText:{type:String,default:"\u53D6\u6D88"},showSure:{type:Boolean,default:!0},showCancel:{type:Boolean,default:!0},isAdd:Boolean,isEdit:Boolean,isMore:Boolean,sureFn:Function},emits:["sure","clear","update:modelValue"],setup(t,{emit:u,attrs:d,slots:a}){const o=e.computed(()=>{let l="\u65B0\u5EFA";return t.isEdit&&(l="\u7F16\u8F91"),t.isMore&&(l="\u8BE6\u60C5"),l}),n=e.computed({get:()=>t.isAdd||t.isMore||t.isEdit,set:l=>null}),s=async()=>{if(!(t.sureFn&&await t.sureFn()===!1)){if(t.isMore){u("clear");return}u("update:modelValue",!1),u("sure")}},i=()=>{if(t.isMore||!t.showCancel){u("clear"),u("update:modelValue",!1);return}f.ElMessageBox.confirm("\u6570\u636E\u672A\u4FDD\u5B58\uFF0C\u5173\u95ED\u5C06\u4E22\u5931\u6570\u636E\uFF0C\u786E\u8BA4\u5173\u95ED\uFF1F","\u63D0\u793A").then(()=>{u("update:modelValue",!1),u("clear")}).catch(()=>null)};return()=>e.createVNode(e.Teleport,{to:"body"},{default:()=>[e.createVNode(f.ElDialog,e.mergeProps(d,{modelValue:t.modelValue||n.value,title:t.realTitle||o.value,closeOnClickModal:!1,closeOnPressEscape:!1,beforeClose:i}),{default:()=>{var l;return(l=a.body)==null?void 0:l.call(a)},footer:()=>{var l,r,g;return e.createVNode(e.Fragment,null,[(l=a.button)==null?void 0:l.call(a),t.showCancel&&e.createVNode(f.ElButton,{onClick:()=>i()},{default:()=>[t.cancelText]}),(r=a.step1)==null?void 0:r.call(a),(g=a.step2)==null?void 0:g.call(a),t.showSure&&e.createVNode(f.ElButton,{type:"primary",onClick:()=>s()},{default:()=>[t.sureText]})])}})]})}});function F(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!e.isVNode(t)}const M=e.defineComponent({props:{options:{type:Object,required:!0}},setup(t,{attrs:u}){const d=v.randomId();return()=>{let a;return e.createVNode(f.ElSelect,u,F(a=t.options.map((o,n)=>e.createVNode(f.ElOption,e.mergeProps(o,{key:n+d}),null)))?a:{default:()=>[a]})}}}),S=(t,u,d=10,a=e.ref(!1))=>{const o=e.ref([]),n=e.ref(!1),s=e.ref(1),i=()=>{const{stop:l}=x.useIntersectionObserver(o.value[t.value.length-1],([{isIntersecting:r}])=>{r&&(n.value=r,l())})};return e.watchEffect(async()=>{if(!a.value&&n.value){if(t.value.length===u.value.length)return;s.value++;const l=u.value.slice(d*(s.value-1),d*s.value);if(l.length===0)return;t.value.push(...l),n.value=!1,await e.nextTick(),i()}}),{elArr:o,touchEndEl:n,page:s,load:i}},q=(t,{addCbk:u,modCbk:d,delCbk:a,cpEffect:o,cgEffect:n,disableclear:s},i="\u786E\u8BA4\u5220\u9664\u8BE5\u6761\u6570\u636E\uFF1F")=>{const l=e.ref(!1),r=e.ref(!1),g=e.ref(!1),c=e.ref(v.deepClone(t)),y=e.ref(),m=async()=>await new Promise(V=>{var w;(w=y.value)==null||w.validate(async N=>{N&&V(!0)}).catch(N=>{V(!1)})}),h=()=>{l.value=!1,r.value=!1,g.value=!1,c.value=v.deepClone(t)};return{isAdd:l,isEdit:r,isMore:g,clear:h,edit:p=>{o==null||o(p),c.value=v.deepClone(p),r.value=!0},more:p=>{o==null||o(p),c.value=v.deepClone(p),g.value=!0},form:c,del:p=>{f.ElMessageBox.confirm(i,"\u63D0\u793A",{type:"warning"}).then(async()=>{await(a==null?void 0:a(p)),n==null||n()}).catch(()=>null)},sure:async()=>{if(l.value){if(await(u==null?void 0:u())===!1)return}else if(await(d==null?void 0:d())===!1)return;!s&&h(),n==null||n()},formRef:y,validForm:m}};exports.YoungDialog=P;exports.YoungPagination=B;exports.YoungSelect=M;exports.YoungTable=T;exports.useAutoLoad=S;exports.useFormMode=q;
//# sourceMappingURL=index.cjs.js.map
