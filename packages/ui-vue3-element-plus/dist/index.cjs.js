"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),m=require("@bluesyoung/utils"),v=require("element-plus"),T=require("@vueuse/core"),B=e.defineComponent({props:{tableData:{type:Object,required:!0},tableHead:{type:Object,required:!0},tableHeight:{type:Number,default:600}},emits:["sort-change"],setup(t,{emit:u,attrs:d,slots:a}){const o=e.ref(null);e.onActivated(()=>{e.nextTick(()=>{o.value.doLayout()})});const l=e.ref([]),s=e.ref([]);return e.watchEffect(()=>{const i=t.tableData,n=t.tableHead,r=i.length;e.nextTick(()=>{s.value=n.filter(c=>!c.only_export);const g=50;if(r<=g)l.value=m.deepClone(i);else{const{elArr:c,load:y}=x(l,e.ref(i),g);let h=0;l.value=i.slice(h,g),e.nextTick(()=>{c.value=o.value.$el.querySelector("tbody").children,y()})}})}),()=>e.createVNode(v.ElTable,e.mergeProps(d,{ref:o,data:l.value,style:"width: 100%",height:t.tableHeight,onSortChange:i=>u("sort-change",i)}),{default:()=>{var i,n;return[s.value.map((r,g)=>e.createVNode(v.ElTableColumn,{key:g,prop:r.prop,label:r.label,width:r.width||"",sortable:r.sortable||!1,fixed:r.fixed||!1,align:r.aligin||"left"},{header:c=>s.value[c.$index].tool_content?e.createVNode(e.Fragment,null,[e.createVNode("span",null,[c.column.label]),e.createVNode(v.ElTooltip,{placement:"bottom"},{content:()=>s.value[c.$index].tool_content})]):e.createVNode("span",null,[c.column.label]),default:c=>r.render?e.createVNode(e.resolveComponent("component"),{is:r.render(c.row)},null):e.createVNode("span",null,[c.row[r.prop]])})),(i=a.switch)==null?void 0:i.call(a),(n=a.operate)==null?void 0:n.call(a)]}})}}),p={type:Number,required:!0},S=e.defineComponent({props:{total:p,page:p,limit:p,pageSizes:{type:Object,default:()=>[10,20,30,50]},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},emits:["page-change","update:page","update:limit"],setup(t,{emit:u,attrs:d}){const a=l=>{u("update:page",1),u("update:limit",l),u("page-change")},o=l=>{u("update:page",l),u("page-change")};return()=>e.createVNode("div",{style:"background: white; padding-top: 20px;"},[e.createVNode(v.ElPagination,e.mergeProps(d,{background:t.background,currentPage:t.page,pageSize:t.limit,layout:t.layout,pageSizes:t.pageSizes,total:t.total,"onSize-change":l=>a(l),"onCurrent-change":l=>o(l)}),null)])}}),F=e.defineComponent({props:{modelValue:Boolean,realTitle:String,sureText:{type:String,default:"\u786E\u5B9A"},cancelText:{type:String,default:"\u53D6\u6D88"},showSure:{type:Boolean,default:!0},showCancel:{type:Boolean,default:!0},isAdd:Boolean,isEdit:Boolean,isMore:Boolean,sureFn:Function},emits:["sure","clear","update:modelValue"],setup(t,{emit:u,attrs:d,slots:a}){const o=e.computed(()=>{let n="\u65B0\u5EFA";return t.isEdit&&(n="\u7F16\u8F91"),t.isMore&&(n="\u8BE6\u60C5"),n}),l=e.computed({get:()=>t.isAdd||t.isMore||t.isEdit,set:n=>null}),s=async()=>{if(!(t.sureFn&&await t.sureFn()===!1)){if(t.isMore){u("clear");return}u("update:modelValue",!1),u("sure")}},i=()=>{if(t.isMore||!t.showCancel){u("clear"),u("update:modelValue",!1);return}v.ElMessageBox.confirm("\u6570\u636E\u672A\u4FDD\u5B58\uFF0C\u5173\u95ED\u5C06\u4E22\u5931\u6570\u636E\uFF0C\u786E\u8BA4\u5173\u95ED\uFF1F","\u63D0\u793A").then(()=>{u("update:modelValue",!1),u("clear")}).catch(()=>null)};return()=>e.createVNode(e.Teleport,{to:"body"},{default:()=>[e.createVNode(v.ElDialog,e.mergeProps(d,{modelValue:t.modelValue||l.value,title:t.realTitle||o.value,closeOnClickModal:!1,closeOnPressEscape:!1,beforeClose:i}),{default:()=>{var n;return(n=a.body)==null?void 0:n.call(a)},footer:()=>{var n,r,g;return e.createVNode(e.Fragment,null,[(n=a.button)==null?void 0:n.call(a),t.showCancel&&e.createVNode(v.ElButton,{onClick:()=>i()},{default:()=>[t.cancelText]}),(r=a.step1)==null?void 0:r.call(a),(g=a.step2)==null?void 0:g.call(a),t.showSure&&e.createVNode(v.ElButton,{type:"primary",onClick:()=>s()},{default:()=>[t.sureText]})])}})]})}}),x=(t,u,d=10,a=e.ref(!1))=>{const o=e.ref([]),l=e.ref(!1),s=e.ref(1),i=()=>{const{stop:n}=T.useIntersectionObserver(o.value[t.value.length-1],([{isIntersecting:r}])=>{r&&(l.value=r,n())})};return e.watchEffect(async()=>{if(!a.value&&l.value){if(t.value.length===u.value.length)return;s.value++;const n=u.value.slice(d*(s.value-1),d*s.value);if(n.length===0)return;t.value.push(...n),l.value=!1,await e.nextTick(),i()}}),{elArr:o,touchEndEl:l,page:s,load:i}},M=(t,{addCbk:u,modCbk:d,delCbk:a,cpEffect:o,cgEffect:l,disableclear:s},i="\u786E\u8BA4\u5220\u9664\u8BE5\u6761\u6570\u636E\uFF1F")=>{const n=e.ref(!1),r=e.ref(!1),g=e.ref(!1),c=e.ref(m.deepClone(t)),y=e.ref(),h=async()=>await new Promise(V=>{var w;(w=y.value)==null||w.validate(async N=>{N&&V(!0)}).catch(N=>{V(!1)})}),b=()=>{n.value=!1,r.value=!1,g.value=!1,c.value=m.deepClone(t)};return{isAdd:n,isEdit:r,isMore:g,clear:b,edit:f=>{o==null||o(f),c.value=m.deepClone(f),r.value=!0},more:f=>{o==null||o(f),c.value=m.deepClone(f),g.value=!0},form:c,del:f=>{v.ElMessageBox.confirm(i,"\u63D0\u793A",{type:"warning"}).then(async()=>{await(a==null?void 0:a(f)),l==null||l()}).catch(()=>null)},sure:async()=>{if(n.value){if(await(u==null?void 0:u())===!1)return}else if(await(d==null?void 0:d())===!1)return;!s&&b(),l==null||l()},formRef:y,validForm:h}};exports.YoungDialog=F;exports.YoungPagination=S;exports.YoungTable=B;exports.useAutoLoad=x;exports.useFormMode=M;
//# sourceMappingURL=index.cjs.js.map
